{"version":3,"file":"wm-google-map-marker.js","sourceRoot":"","sources":["wm-google-map-marker.ts"],"names":[],"mappings":"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","sourcesContent":["import { LitElement } from \"lit\";\nimport { customElement, property } from \"lit/decorators\";\n\n@customElement(\"wm-google-map-marker\")\nexport class WebmarketsGoogleMapMarker extends LitElement {\n  @property({ type: Number, reflect: true })\n  latitude: number = 0;\n\n  @property({ type: Number, reflect: true })\n  longitude: number = 0;\n\n  @property({ type: String, reflect: true })\n  label: string | null = null;\n\n  @property({ type: Number, reflect: true, attribute: \"z-index\" })\n  zIndex: number = 0;\n\n  @property({ type: Boolean, reflect: true })\n  open: boolean = false;\n\n  map: google.maps.Map = null;\n  marker: google.maps.Marker = null;\n  info: google.maps.InfoWindow;\n  contentObserver: MutationObserver;\n  openInfoHandler: google.maps.MapsEventListener;\n  closeInfoHandler: google.maps.MapsEventListener;\n\n  @property({ type: Boolean, reflect: true })\n  autopopup: boolean = false;\n\n  connectedCallback() {\n    super.connectedCallback();\n    window.addEventListener(\n      \"load\",\n      this.autopopup\n        ? () => this._autoPopupMarker()\n        : () => console.log(\"Not auto\")\n    );\n  }\n  disconnectedCallback() {\n    window.removeEventListener(\n      \"load\",\n      this.autopopup\n        ? () => this._autoPopupMarker()\n        : () => console.log(\"Not auto\")\n    );\n    super.disconnectedCallback();\n  }\n\n  _autoPopupMarker() {\n    if (!this.info) return;\n\n    this.info.open(this.map, this.marker);\n    this.dispatchEvent(\n      new CustomEvent(\"google-map-marker-open\", { bubbles: true })\n    );\n  }\n\n  attributeChangedCallback(name: string, oldval: any, newval: any) {\n    super.attributeChangedCallback(name, oldval, newval);\n    switch (name) {\n      case \"open\": {\n        this.openChanged();\n        break;\n      }\n      case \"latitude\": {\n        this.updatePosition();\n        break;\n      }\n      case \"longitude\": {\n        this.updatePosition();\n        break;\n      }\n      case \"label\": {\n        this.marker?.setLabel(newval);\n        break;\n      }\n      case \"z-index\": {\n        this.marker?.setZIndex(newval);\n        break;\n      }\n    }\n  }\n\n  openChanged() {\n    if (!this.info) return;\n\n    if (this.open) {\n      this.info.open(this.map, this.marker);\n      this.dispatchEvent(\n        new CustomEvent(\"google-map-marker-open\", { bubbles: true })\n      );\n    } else {\n      this.info.close();\n      this.dispatchEvent(\n        new CustomEvent(\"google-map-marker-close\", { bubbles: true })\n      );\n    }\n  }\n\n  updatePosition() {\n    this.marker?.setPosition(\n      new google.maps.LatLng(this.latitude, this.longitude)\n    );\n  }\n\n  changeMap(newMap: google.maps.Map) {\n    this.map = newMap;\n    this.mapChanged();\n  }\n\n  mapChanged() {\n    // Marker will be rebuilt, so disconnect existing one from old map and listeners.\n    if (this.marker) {\n      this.marker.setMap(null);\n      google.maps.event.clearInstanceListeners(this.marker);\n    }\n\n    if (this.map && this.map instanceof google.maps.Map) {\n      this.mapReady();\n    }\n  }\n\n  mapReady() {\n    this.marker = new google.maps.Marker({\n      map: this.map,\n      position: {\n        lat: this.latitude,\n        lng: this.longitude,\n      },\n      label: this.label,\n      zIndex: this.zIndex,\n    });\n\n    this.contentChanged();\n  }\n\n  contentChanged() {\n    if (this.contentObserver) this.contentObserver.disconnect();\n\n    this.contentObserver = new MutationObserver(this.contentChanged.bind(this));\n    this.contentObserver.observe(this, {\n      childList: true,\n      subtree: true,\n    });\n\n    var content = this.innerHTML.trim();\n    if (content) {\n      if (!this.info) {\n        this.info = new google.maps.InfoWindow();\n\n        this.openInfoHandler = google.maps.event.addListener(\n          this.marker,\n          \"click\",\n          function () {\n            this.open = true;\n          }.bind(this)\n        );\n\n        this.closeInfoHandler = google.maps.event.addListener(\n          this.info,\n          \"closeclick\",\n          function () {\n            this.open = false;\n          }.bind(this)\n        );\n      }\n      this.info.setContent(content);\n    } else {\n      if (this.info) {\n        // Destroy the existing infowindow.  It doesn't make sense to have an empty one.\n        google.maps.event.removeListener(this.openInfoHandler);\n        google.maps.event.removeListener(this.closeInfoHandler);\n        this.info = null;\n      }\n    }\n  }\n}\n"]}