{"version":3,"file":"wm-google-map.js","sourceRoot":"","sources":["wm-google-map.ts"],"names":[],"mappings":"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","sourcesContent":["import { html, css, LitElement } from \"lit\";\nimport { customElement, property } from \"lit/decorators\";\nimport {LitGoogleMapsApi} from './lit-google-maps-api';\nimport { WebmarketsGoogleMapMarker } from './wm-google-map-marker';\nimport {LitSelector} from './lit-selector';\n\n@customElement('wm-google-map')\nexport class WebmarketsGoogleMap extends LitElement {\n\n    /**\n     * A Maps API key. To obtain an API key, see https://developers.google.com/maps/documentation/javascript/tutorial#api_key.\n     */\n    @property({type : String, attribute: 'api-key'})\n    apiKey: string = '';\n\n    /**\n     * Version of the Google Maps API to use.\n     */\n    @property({type : String})\n    version: string = '3.39';\n\n    /**\n     * If set, custom styles can be applied to the map.\n     * For style documentation see https://developers.google.com/maps/documentation/javascript/reference#MapTypeStyle\n    */\n    @property({type : Object})\n    styles: object = [{\"featureType\":\"administrative\",\"elementType\":\"geometry\",\"stylers\":[{\"visibility\":\"off\"}]},{\"featureType\":\"administrative.land_parcel\",\"elementType\":\"labels\",\"stylers\":[{\"visibility\":\"off\"}]},{\"featureType\":\"poi\",\"stylers\":[{\"visibility\":\"off\"}]},{\"featureType\":\"road\",\"elementType\":\"labels.icon\",\"stylers\":[{\"visibility\":\"off\"}]},{\"featureType\":\"road.local\",\"eleme ntType\":\"labels\",\"stylers\":[{\"visibility\":\"off\"}]},{\"featureType\":\"transit\",\"stylers\":[{\"visibility\":\"off\"}]}];\n\n    /**\n     * A zoom level to set the map to.\n     */\n    @property({type : Number})\n    zoom: number = 8;\n\n    /**\n     * If set, the zoom level is set such that all markers (google-map-marker children) are brought into view.\n     */\n    @property({type : Boolean, attribute: 'fit-to-markers'})\n    fitToMarkers: boolean = false;\n\n    /**\n     * Map type to display. One of 'roadmap', 'satellite', 'hybrid', 'terrain'.\n     */\n    @property({type : String, attribute: 'map-type'})\n    mapType: string = 'roadmap';\n\n    @property({type : Number, attribute: 'center-latitude'})\n    centerLatitude: number = -34.397;\n\n    @property({type : Number, attribute: 'center-longitude'})\n    centerLongitude: number = 150.644;\n\n    map : google.maps.Map = null;\n\n    markers : Array<Node>;\n\n    marketObserverSet : boolean;\n\n    initGMap() {\n        if (this.map != null) {\n            return; // already initialized\n        }\n\n        var gMapApiElement = this.shadowRoot.getElementById('api') as LitGoogleMapsApi;\n\n        if (gMapApiElement == null || gMapApiElement.libraryLoaded != true) {\n            return;\n        }\n\n        this.map = new google.maps.Map(this.shadowRoot.getElementById('map'), this.getMapOptions());\n\n        this.updateMarkers();\n    }\n\n    getMapOptions() : google.maps.MapOptions {\n        return {\n            zoom: this.zoom,\n            center: {lat: this.centerLatitude, lng: this.centerLongitude},\n            mapTypeId: this.mapType,\n            // @ts-ignore\n            styles: this.styles\n        };\n    }\n\n    mapApiLoaded() {\n        this.initGMap();\n    }\n\n    connectedCallback() {\n        super.connectedCallback();\n\n        this.initGMap();\n    }\n\n    attachChildrenToMap(children : Array<Node>) {\n        if (this.map) {\n          for (var i = 0, child; child = children[i]; ++i) {\n            (child as WebmarketsGoogleMapMarker).changeMap(this.map);\n          }\n        }\n    }\n\n    observeMarkers() {\n        if (this.marketObserverSet)\n            return;\n\n        this.addEventListener(\"items-changed\", event => { this.updateMarkers() });\n        this.marketObserverSet = true;\n    }\n\n    updateMarkers() {\n        this.observeMarkers();\n\n        var markersSelector = this.shadowRoot.getElementById(\"markers-selector\") as LitSelector;\n        if (!markersSelector)\n            return;\n\n        var newMarkers = markersSelector.items;\n\n        // do not recompute if markers have not been added or removed\n        if (this.markers && newMarkers.length === this.markers.length)\n        {\n            var added = newMarkers.filter(m => {\n                return this.markers && this.markers.indexOf(m) === -1;\n            });\n            if (added.length == 0)\n                return\n        }\n\n        this.markers = newMarkers;\n\n        this.attachChildrenToMap(this.markers);\n\n        if (this.fitToMarkers) {\n            this.fitToMarkersChanged();\n        }\n    }\n\n    fitToMarkersChanged() {\n        if (this.map && this.fitToMarkers && this.markers.length > 0) {\n            var latLngBounds = new google.maps.LatLngBounds();\n            for (var i = 0, m; m = this.markers[i]; ++i) {\n                latLngBounds.extend(new google.maps.LatLng(m.latitude, m.longitude));\n            }\n\n            // For one marker, don't alter zoom, just center it.\n            if (this.markers.length > 1) {\n                this.map.fitBounds(latLngBounds);\n            }\n\n            this.map.setCenter(latLngBounds.getCenter());\n        }\n    }\n\n    deselectMarker(event : Event) {\n    }\n\n    static get styles() {\n        return css`\n            #map {\n                width: 100%;\n                height: 100%;\n            }\n        `;\n    }\n\n    render() {\n        return html`\n            <lit-google-maps-api id=\"api\" api-key=${this.apiKey} version=${this.version} @api-load=${() => this.mapApiLoaded()}></lit-google-maps-api>\n            <lit-selector \n                id=\"markers-selector\"\n                selected-attribute=\"open\"\n                activate-event=\"google-map-marker-open\"\n                @google-map-marker-close=${(e) => this.deselectMarker(e)}>\n                    <slot id=\"markers\" name=\"markers\"></slot>\n            </lit-selector>\n            <div id=\"map\">\n            </div>\n        `;\n    }\n}"]}