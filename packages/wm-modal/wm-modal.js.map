{"version":3,"file":"wm-modal.js","sourceRoot":"","sources":["wm-modal.ts"],"names":[],"mappings":"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","sourcesContent":["import { LitElement, html, css } from \"lit\";\nimport { customElement, property, query } from \"lit/decorators.js\";\n\n/**\n * An example element.\n *\n * @slot - This element has a slot\n * @csspart button - The button\n * \n */\n \nexport const tagName = 'wm-modal';\n\n@customElement(\"wm-modal\")\nexport class WebmarketsModal extends LitElement {\n  static styles = css`\n    :host([isopen]) {\n      z-index: 9998;\n      position: fixed;\n      width: 100%;\n      height: 100%;\n      top: 0;\n      left: 0;\n      background: rgba(0, 0, 0, 0.3);\n    }\n  `;\n\n  @property({ type: Boolean, reflect: true }) isOpen = false;\n  @property({type: Boolean, reflect: true }) popupeonce = false;\n  @property({type: Boolean, reflect: true }) autopopup = false;\n  @property({type: Boolean, reflect: true }) popupeveryvisit = false;\n  @property({type: Number, reflect: true }) popupdelay = 5000;\n\n\n  @query('#modal__slot')\n  modalSlot!: HTMLDivElement;\n\n  connectedCallback() {\n    super.connectedCallback();\n    window.addEventListener('load', this.autopopup ? (e) => this._autoPopupModal(e) : () => console.log('Not auto'));\n    window.addEventListener('click', this._handleClickedAway);\n    window.addEventListener(\"keydown\", (e: KeyboardEvent) =>\n      this._keyListener(e)\n    );\n  }\n  disconnectedCallback() {\n    window.removeEventListener('load', this.autopopup ? (e) => this._autoPopupModal(e) : () => console.log('Not auto'));\n    window.removeEventListener('click', this._handleClickedAway);\n    window.removeEventListener(\"keydown\", (e: KeyboardEvent) =>\n      this._keyListener(e)\n    );\n    super.disconnectedCallback();\n  }\n\n\n\n  _autoPopupModal(e: Event) {\n    e.stopPropagation();\n    // if popupeonce attribute is enabled go through this function\n    if(this.popupeonce) {\n      let popupHasBeenLoaded = localStorage.getItem(\"popup-loaded\");\n      // if the popup-loaded localstorage item exists then we'll return\n      if(popupHasBeenLoaded) {\n        return;\n      } \n      // otherwise we'll open the popup\n      else {\n        // wait for however long the delay is\n        setTimeout(() => { this.isOpen = true; }, this.popupdelay);\n        // set a local storage item named popup-loaded\n        localStorage.setItem(\"popup-loaded\", 'true');\n      }\n    }\n    // if popupeveryvisit attribute is enabled go through this function\n    if(this.popupeveryvisit) {\n      let popupHasBeenLoaded = sessionStorage.getItem(\"popup-loaded\");\n      // if the popup-loaded localstorage item exists then we'll return\n      if(popupHasBeenLoaded) {\n        return;\n      } \n      // otherwise we'll open the popup\n      else {\n        // wait for however long the delay is\n        setTimeout(() => { this.isOpen = true; }, this.popupdelay);\n        // set a local storage item named popup-loaded\n        sessionStorage.setItem(\"popup-loaded\", 'true');\n      }\n    }\n    // if popupeveryvisit or popuponce aren't enabled then open the popup after whatever the delay is\n    else {\n      setTimeout(() => { this.isOpen = true; }, this.popupdelay);\n    }\n  }\n\n  _handleClickedAway = (e: MouseEvent) => {\n    // if the modal is open do nothing\n    if (!this.isOpen) {\n      return;\n    }\n    // if the click is on the modal container do nothing\n    if (e.composedPath().includes(this.modalSlot)) {\n      // console.log('modal container clicked');\n    } else {\n      // if it's not on the tainer dispatch the event\n      // console.log('window clicked');\n      this._dispatchClickedAway();\n    }\n  };\n\n  _dispatchClickedAway() {\n    const options = {\n      bubbles: true,\n      composed: true,\n    };\n    this.dispatchEvent(new CustomEvent('clicked-away', options));\n  }\n\n  _keyListener(e: KeyboardEvent) {\n    // if they press the ESC key start recording\n    if (e.key === \"Escape\") {\n      // e.preventDefault();\n      this.isOpen = false;\n      document.body.toggleAttribute('no-scroll');\n    }\n  }\n\n  render() {\n    return html`${this.isOpen\n      ? html`<div>\n        <slot id=\"modal__slot\"></slot>\n      </div>`\n      : ''}`;\n  }\n}\n"]}